<Modal @ref="selectModal" Title="Select an Option">
    <BodyTemplate>
        <AutoComplete @bind-Value="typeName"
            TItem="Type"
            DataProvider="TypeDataProvider"
            PropertyName="Name"
            Placeholder="Search a type..."
            OnChanged="OnAutoCompleteChanged" />
    </BodyTemplate>
</Modal>

@code {
    private Modal selectModal = default!;
    private TaskCompletionSource<Type?>? tcs;
    private string? typeName;
    
    private async Task<AutoCompleteDataProviderResult<Type>> TypeDataProvider(AutoCompleteDataProviderRequest<Type> request) {
        return await Task.FromResult(request.ApplyTo(refService.getAllTypes()));
    }

    private void OnAutoCompleteChanged(Type type)
    {
        tcs?.SetResult(type);
        selectModal.HideAsync();
    }

    public async Task<Type?> ShowAsync()
    {
        tcs = new TaskCompletionSource<Type?>();
        await selectModal.ShowAsync();
        return await tcs.Task;
    }
}

